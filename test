import os
import json
import csv
import re
import faker

def replace_sensitive_data(text):
    # Use Faker to generate random words
    fake = faker.Faker()
    
    # Replace email addresses
    text = re.sub(r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b', fake.email(), text)
    
    # Replace IP addresses
    text = re.sub(r'\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b', fake.ipv4(), text)
    
    # Replace real names (assuming names start with capital letters)
    text = re.sub(r'\b[A-Z][a-z]*\b', fake.name(), text)

    # Replace domain names
    text = re.sub(r'\b[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b', fake.domain_name(), text)
    
    return text

def process_file(file_path):
    with open(file_path, 'r') as file:
        content = file.read()
        
    content = replace_sensitive_data(content)
    
    with open(file_path, 'w') as file:
        file.write(content)

def process_directory(folder_path):
    for root, dirs, files in os.walk(folder_path):
        for file_name in files:
            file_path = os.path.join(root, file_name)
            
            if file_name.endswith('.json'):
                # Process JSON files
                with open(file_path, 'r') as json_file:
                    data = json.load(json_file)
                    
                for key in data:
                    data[key] = replace_sensitive_data(str(data[key]))
                
                with open(file_path, 'w') as json_file:
                    json.dump(data, json_file, indent=2)
                    
            elif file_name.endswith('.csv'):
                # Process CSV files
                with open(file_path, 'r') as csv_file:
                    reader = csv.reader(csv_file)
                    rows = list(reader)
                    
                for row in rows:
                    for i in range(len(row)):
                        row[i] = replace_sensitive_data(row[i])
                        
                with open(file_path, 'w', newline='') as csv_file:
                    writer = csv.writer(csv_file)
                    writer.writerows(rows)
                    
            else:
                # Process other text files
                process_file(file_path)

# Example usage:
folder_path = '/path/to/your/folder'
process_directory(folder_path)
